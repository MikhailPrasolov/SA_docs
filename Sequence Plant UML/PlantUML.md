# üìä –î–∏–∞–≥—Ä–∞–º–º–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (Sequence Diagram) ‚Äî –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

## üìå –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–î–∞–Ω–Ω–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ –æ–ø–∏—Å—ã–≤–∞–µ—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏–π –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º, —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º, –±—ç–∫–µ–Ω–¥–æ–º –∏ –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–∞–º–∫–∞—Ö –∫–ª—é—á–µ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏.

–û–Ω–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞:
- –¥–ª—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞;
- –∫–∞–∫ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥/–±—ç–∫–µ–Ω–¥-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤;
- –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ –ø—Ä–∏ —Ä–µ–≤—å—é –∏–ª–∏ –ø–µ—Ä–µ–¥–∞—á–µ –≤ –¥—Ä—É–≥–∏–µ –∫–æ–º–∞–Ω–¥—ã.

---

## üìö –û–ø–∏—Å—ã–≤–∞–µ–º—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç email, –ø–∞—Ä–æ–ª—å –∏ –¥—Ä—É–≥–∏–µ –¥–∞–Ω–Ω—ã–µ.
- –§—Ä–æ–Ω—Ç–µ–Ω–¥ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ `/api/users/register`.
- –ë—ç–∫–µ–Ω–¥ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ, —Ö—ç—à–∏—Ä—É–µ—Ç –ø–∞—Ä–æ–ª—å –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ë–î.
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –æ—Ç–≤–µ—Ç `201 Created`.

### üîê –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç email –∏ –ø–∞—Ä–æ–ª—å.
- –ë—ç–∫–µ–Ω–¥ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ö—ç—à –ø–∞—Ä–æ–ª—è –∏ –≤—ã–¥–∞–µ—Ç JWT.
- –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è —Å–æ–±—ã—Ç–∏–µ –≤ —Ç–∞–±–ª–∏—Ü—É –∏—Å—Ç–æ—Ä–∏–∏ –≤—Ö–æ–¥–æ–≤ `user_login_history`.

### üé≠ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ `/api/users/{id}/roles`.
- –í —Ç–∞–±–ª–∏—Ü—É `user_roles` –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –Ω–æ–≤–∞—è –∑–∞–ø–∏—Å—å, —Å–≤—è–∑—ã–≤–∞—é—â–∞—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å —Ä–æ–ª—å—é.

### üóë –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –º—è–≥–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ (soft delete) ‚Äî —Å—Ç–∞—Ç—É—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Ç–∞–±–ª–∏—Ü–µ `users` –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ `'deleted'`.
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –æ—Ç–≤–µ—Ç `204 No Content`.

---

## üß© –£—á–∞—Å—Ç–Ω–∏–∫–∏ –¥–∏–∞–≥—Ä–∞–º–º—ã

| –£—á–∞—Å—Ç–Ω–∏–∫         | –†–æ–ª—å                                                         |
|------------------|--------------------------------------------------------------|
| **User**         | –ò–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç –¥–µ–π—Å—Ç–≤–∏—è —á–µ—Ä–µ–∑ UI                                 |
| **Frontend (FE)**| –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –∏ –æ—Ç–ø—Ä–∞–≤–∫—É –∑–∞–ø—Ä–æ—Å–æ–≤ |
| **Backend (BE)** | –û—Å–Ω–æ–≤–Ω–∞—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞, —Ä–∞–±–æ—Ç–∞ —Å –ë–î             |
| **PostgreSQL DB**| –•—Ä–∞–Ω–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Ä–æ–ª–∏, –∏—Å—Ç–æ—Ä–∏—é –≤—Ö–æ–¥–æ–≤ –∏ —Å—Ç–∞—Ç—É—Å—ã         |

---

## üñºÔ∏è –ü—Ä–∏–º–µ—Ä –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏

–ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ [PlantUML](https://plantuml.com/ru/sequence-diagram), –≤—ã –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏—Å–æ–≤–∞—Ç—å `.puml` —Ñ–∞–π–ª –∏ –ø–æ–ª—É—á–∏—Ç—å –Ω–∞ –≤—ã—Ö–æ–¥–µ –¥–∏–∞–≥—Ä–∞–º–º—É –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –∫–∞–∫ –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ –Ω–∏–∂–µ:

![sequence-diagram](docs/sequence-user-ms.png)

---

## üõ† –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **PlantUML** –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π
- **Markdown** –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- **PostgreSQL** ‚Äî –≤ –∫–∞—á–µ—Å—Ç–≤–µ –°–£–ë–î
- **REST API** ‚Äî –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π —Å—Ç–∏–ª—å –¥–ª—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏

---

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [`schema.dbml`](../schema.dbml) ‚Äî –æ–ø–∏—Å–∞–Ω–∏–µ —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- [`openapi.yaml`](../openapi.yaml) ‚Äî Swagger-—Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è API (–µ—Å–ª–∏ –µ—Å—Ç—å)
- [`README.md`](./README.md) ‚Äî —ç—Ç–æ—Ç —Ñ–∞–π–ª

---

–ê–≤—Ç–æ—Ä: –ü—Ä–∞—Å–æ–ª–æ–≤ –ú–∏—Ö–∞–∏–ª

Telegram: t.me/systemananalytics
